<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Admin Panel</title>
    <link rel="icon" href="./logo.png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>

<style>
    @media screen and (max-width: 430px) {
        .container {
            flex-direction: column;
        }

        #addProductForm {
            width: 100%;
            max-width: 400px;
        }

        #productList {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }

        .card {
            width: 300px;
        }

        .modal-dialog {
            width: 300px;
        }

        .divcha {
            width: 100%;
            max-width: 400px;
        }

        header {
            padding: 20px 10px;
        }
    }

    @media screen and (max-width: 375px) {
        .container {
            flex-direction: column;
        }

        #addProductForm {
            width: 100%;
            max-width: 350px;
        }

        #productList {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }

        .card {
            width: 280px;
        }

        .divcha {
            width: 100%;
            max-width: 320px;
        }

        .modal-dialog {
            width: 300px;
        }

        header {
            padding: 20px 10px;
        }
    }

    @media screen and (max-width: 320px) {
        .container {
            flex-direction: column;
        }

        #addProductForm {
            width: 100%;
            max-width: 300px;
        }

        #productList {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }

        .card {
            width: 270px;
        }

        .divcha {
            width: 100%;
            max-width: 300px;
        }

        .modal-dialog {
            width: 280px;
        }

        .hero {
            padding: 100px 10px;
        }

        .logo img {
            width: 80px;
        }

        .ul li {
            flex-direction: column;
        }
    }

    .divcha {
        width: 100%;
        max-width: 900px;
    }

    .admin-section {
        padding: 60px 0;
        min-height: calc(100vh - 200px);
    }

    .section-title {
        text-align: center;
        margin-bottom: 40px;
        font-size: 2.5rem;
        font-weight: 700;
    }

    :root {
        --primary-color: #1a365d;
        --secondary-color: #2d5a87;
        --accent-color: #e53e3e;
        --gold-color: #ffd700;
        --text-dark: #2d3748;
        --text-light: #718096;
        --bg-light: #f7fafc;
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        transition: all 0.3s ease;
    }

    .navbar {
        background: rgba(255, 255, 255, 0.95) !important;
        backdrop-filter: blur(10px);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        padding: 1rem 0;
        position: sticky;
        top: 0;
        z-index: 1000;
    }

    .navbar-brand {
        font-size: 1.8rem;
        font-weight: bold;
        background: linear-gradient(45deg, #e53e3e, #ffd700);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
    }

    .nav-link {
        font-weight: 600;
        color: var(--text-dark) !important;
        margin: 0 15px;
        position: relative;
        transition: all 0.3s ease;
    }

    .nav-link:hover {
        color: var(--accent-color) !important;
        transform: translateY(-2px);
    }

    .nav-link::after {
        content: '';
        position: absolute;
        width: 0;
        height: 2px;
        bottom: -5px;
        left: 50%;
        background: var(--accent-color);
        transition: all 0.3s ease;
    }

    .nav-link:hover::after {
        width: 100%;
        left: 0;
    }

    .theme-toggle {
        background: none;
        border: 2px solid var(--accent-color);
        color: var(--accent-color);
        padding: 8px 16px;
        border-radius: 20px;
        transition: all 0.3s ease;
        font-weight: 600;
    }

    .theme-toggle:hover {
        background: var(--accent-color);
        color: white;
        transform: translateY(-2px);
    }

    .feature-card {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        padding: 40px 30px;
        text-align: center;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
        margin-bottom: 30px;
        height: 100%;
    }

    .feature-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
    }

    /* Dark theme */
    body.dark-theme {
        background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
    }

    body.dark-theme .navbar {
        background: rgba(26, 32, 44, 0.95) !important;
    }

    body.dark-theme .nav-link {
        color: #e2e8f0 !important;
    }

    body.dark-theme .feature-card {
        background: rgba(45, 55, 72, 0.95);
        color: #e2e8f0;
    }

    body.dark-theme .section-title {
        color: #e2e8f0;
    }

    body.dark-theme .theme-toggle {
        border-color: #ffd700;
        color: #ffd700;
    }

    body.dark-theme .theme-toggle:hover {
        background: #ffd700;
        color: #1a202c;
    }

    body.dark-theme .card {
        background: rgba(45, 55, 72, 0.95);
        color: #e2e8f0;
        border-color: #4a5568;
    }

    body.dark-theme .form-control {
        background: rgba(45, 55, 72, 0.8);
        border-color: #4a5568;
        color: #e2e8f0;
    }

    body.dark-theme .form-control:focus {
        background: rgba(45, 55, 72, 0.9);
        border-color: #ffd700;
        color: #e2e8f0;
    }

    body.dark-theme .modal-content {
        background: rgba(45, 55, 72, 0.95);
        color: #e2e8f0;
    }

    /* Image upload styles */
    .image-upload-section {
        border: 2px dashed #ddd;
        border-radius: 10px;
        padding: 20px;
        text-align: center;
        margin-bottom: 20px;
        transition: all 0.3s ease;
    }

    .image-upload-section:hover {
        border-color: var(--accent-color);
    }

    .image-preview {
        max-width: 200px;
        max-height: 200px;
        border-radius: 10px;
        margin: 10px 0;
    }

    .upload-btn {
        background: linear-gradient(45deg, #e53e3e, #ffd700);
        border: none;
        color: white;
        padding: 10px 20px;
        border-radius: 25px;
        font-weight: bold;
        transition: all 0.3s ease;
    }

    .upload-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(229, 62, 62, 0.3);
    }

    /* Status badges */
    .status-badge {
        font-size: 0.85rem;
        padding: 5px 10px;
        border-radius: 15px;
        font-weight: bold;
    }

    .status-available {
        background: #d4edda;
        color: #155724;
    }

    .status-order {
        background: #fff3cd;
        color: #856404;
    }

    .gender-badge {
        font-size: 0.75rem;
        padding: 3px 8px;
        border-radius: 10px;
        margin: 2px;
        display: inline-block;
    }

    .gender-male {
        background: #cce5ff;
        color: #0066cc;
    }

    .gender-female {
        background: #ffe6f0;
        color: #cc0066;
    }

    .gender-child {
        background: #fff0e6;
        color: #cc6600;
    }

    /* Enhanced card styling */
    .product-card {
        transition: all 0.3s ease;
        border: none;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    .product-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
    }

    .card-img-top {
        height: 250px;
        object-fit: cover;
        border-radius: 10px 10px 0 0;
    }

    .btn-delete {
        background: linear-gradient(45deg, #dc3545, #c82333);
        border: none;
        color: white;
        transition: all 0.3s ease;
    }

    .btn-delete:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(220, 53, 69, 0.3);
        color: white;
    }

    /* Statistics section */
    .stats-section {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        padding: 30px 0;
        margin-bottom: 30px;
        border-radius: 20px;
    }

    .stat-card {
        background: rgba(255, 255, 255, 0.9);
        border-radius: 15px;
        padding: 25px;
        text-align: center;
        margin-bottom: 20px;
        transition: all 0.3s ease;
    }

    .stat-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    }

    .stat-number {
        font-size: 2.5rem;
        font-weight: bold;
        color: var(--accent-color);
    }

    .stat-label {
        color: var(--text-light);
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    @media (max-width: 768px) {
        .section-title {
            font-size: 2rem;
        }

        .navbar-brand {
            font-size: 1.4rem;
        }

        .stat-number {
            font-size: 2rem;
        }
    }
</style>

<body>
    <header>
        <nav class="navbar navbar-expand-lg">
            <div class="container">
                <a class="navbar-brand" href="index.html">TuronMarket-Adminka</a>

                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav mx-auto">
                        
                    </ul>

                    <div class="d-flex align-items-center gap-2 flex-wrap">
                        <button class="theme-toggle" id="themeToggle" onclick="toggleTheme()">
                            <i class="fas fa-moon"></i> Dark-mode
                        </button>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main style="padding: 20px;">
        <!-- Statistics Section -->
        <section class="stats-section">
            <div class="container">
                <div class="row">
                    <div class="col-md-3 col-sm-6">
                        <div class="stat-card">
                            <div class="stat-number" id="totalProducts">0</div>
                            <div class="stat-label">Total Products</div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6">
                        <div class="stat-card">
                            <div class="stat-number" id="availableProducts">0</div>
                            <div class="stat-label">Available</div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6">
                        <div class="stat-card">
                            <div class="stat-number" id="orderProducts">0</div>
                            <div class="stat-label">On Order</div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6">
                        <div class="stat-card">
                            <div class="stat-number" id="avgPrice">$0</div>
                            <div class="stat-label">Avg Price</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="admin-section">
            <div class="container">
                <h1 class="section-title">Admin Panel</h1>

                <div class="row justify-content-center">
                    <div class="col-lg-10">
                        <div class="card p-4">
                            <h3 class="mb-4 text-center">Add New Product</h3>
                            <form id="addProductForm">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <input type="text" id="productName" placeholder="Product Name"
                                            class="form-control" required>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <input type="number" id="productPrice" placeholder="Price ($)"
                                            class="form-control" required step="0.01">
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <select id="productGender" class="form-control" required>
                                            <option value="">Select Target Gender</option>
                                            <option value="male">Male</option>
                                            <option value="female">Female</option>
                                            <option value="child">Child</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <select id="productStatus" class="form-control" required>
                                            <option value="">Select Status</option>
                                            <option value="available">Available</option>
                                            <option value="order">On Order</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <textarea id="productDescription" placeholder="Product Description"
                                        class="form-control" rows="3" required></textarea>
                                </div>

                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <input type="url" id="productDescriptionURL" placeholder="Description URL (optional)" class="form-control">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <input type="url" id="productWebsite" placeholder="Product Website (optional)" class="form-control">
                                    </div>
                                </div>

                                <!-- Image Upload Section -->
                                <div class="image-upload-section">
                                    <h5>Product Image</h5>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <h6>Upload Image File</h6>
                                            <input type="file" id="productImageFile" class="form-control mb-2" accept="image/*">
                                            <img id="imagePreview" class="image-preview" style="display: none;">
                                        </div>
                                        <div class="col-md-6">
                                            <h6>Or Use Image URL</h6>
                                            <input type="url" id="productImageURL" placeholder="Image URL" class="form-control">
                                            <small class="text-muted">You can use either file upload or URL, not both</small>
                                        </div>
                                    </div>
                                </div>

                                <div class="text-center">
                                    <button type="button" class="btn btn-primary btn-lg" onclick="addProduct()">
                                        <i class="fas fa-plus"></i> Add Product
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section style="display: flex; justify-content: center;" class="products-grid">
            <div class="container">
                <h2 class="section-title">Manage Products</h2>
                <div id="productList" class="row g-4"></div>
            </div>
        </section>
    </main>

    <div class="modal fade" id="editProductModal" tabindex="-1" aria-labelledby="editProductModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editProductModalLabel">Edit Product</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editProductForm">
                        <input type="hidden" id="editProductId">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="editProductName" class="form-label">Product Name</label>
                                <input type="text" id="editProductName" class="form-control" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="editProductPrice" class="form-label">Price ($)</label>
                                <input type="number" id="editProductPrice" class="form-control" required step="0.01">
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="editProductGender" class="form-label">Target Gender</label>
                                <select id="editProductGender" class="form-control" required>
                                    <option value="male">Male</option>
                                    <option value="female">Female</option>
                                    <option value="child">Child</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="editProductStatus" class="form-label">Status</label>
                                <select id="editProductStatus" class="form-control" required>
                                    <option value="available">Available</option>
                                    <option value="order">On Order</option>
                                </select>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="editProductDescription" class="form-label">Description</label>
                            <textarea id="editProductDescription" class="form-control" rows="3" required></textarea>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="editProductDescriptionURL" class="form-label">Description URL</label>
                                <input type="url" id="editProductDescriptionURL" class="form-control">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="editProductWebsite" class="form-label">Product Website</label>
                                <input type="url" id="editProductWebsite" class="form-control">
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="editProductImageURL" class="form-label">Image URL</label>
                            <input type="url" id="editProductImageURL" class="form-control" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" onclick="updateProduct()">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    
    <script>
        const API_URL = "https://6782ae7cc51d092c3dd06dbd.mockapi.io/product/auto_parts";

        // Image file handling
        document.getElementById('productImageFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById('imagePreview');
                    preview.src = e.target.result;
                    preview.style.display = 'block';
                    // Clear URL input when file is selected
                    document.getElementById('productImageURL').value = '';
                };
                reader.readAsDataURL(file);
            }
        });

        async function fetchProducts() {
            try {
                const response = await axios.get(API_URL);
                const products = response.data;
                const productList = document.getElementById('productList');
                
                updateStatistics(products);

                productList.innerHTML = products.map(product => `
                    <div class="col-lg-4 col-md-6">
                        <div class="card product-card h-100">
                            <img src="${product.image || 'https://via.placeholder.com/300x250'}" class="card-img-top" alt="${product.name}" onerror="this.src='https://via.placeholder.com/300x250'">
                            <div class="card-body d-flex flex-column">
                                <div class="mb-2">
                                    <span class="status-badge ${product.status === 'available' ? 'status-available' : 'status-order'}">
                                        <i class="fas ${product.status === 'available' ? 'fa-check-circle' : 'fa-clock'}"></i>
                                        ${product.status === 'available' ? 'Available' : 'On Order'}
                                    </span>
                                    <span class="gender-badge gender-${product.gender || 'unisex'}">
                                        <i class="fas ${getGenderIcon(product.gender)}"></i>
                                        ${product.gender || 'Unisex'}
                                    </span>
                                </div>
                                <h5 class="card-title">${product.name}</h5>
                                <p class="card-text">${product.description}</p>
                                ${product.descriptionURL ? `<p class="card-text"><small><a href="${product.descriptionURL}" target="_blank" class="text-decoration-none"><i class="fas fa-external-link-alt"></i> More Details</a></small></p>` : ''}
                                ${product.website ? `<p class="card-text"><small><a href="${product.website}" target="_blank" class="text-decoration-none"><i class="fas fa-globe"></i> Website</a></small></p>` : ''}
                                <p class="card-text fw-bold text-success fs-5">Price: $${product.price}</p>
                                <div class="mt-auto">
                                    <div class="d-flex gap-2 flex-wrap">
                                        <button class="btn btn-warning flex-fill" onclick="openEditModal('${product.id}', '${escapeQuotes(product.name)}', '${escapeQuotes(product.description)}', ${product.price}, '${product.image}', '${product.gender || 'unisex'}', '${product.status || 'available'}', '${product.descriptionURL || ''}', '${product.website || ''}')">
                                            <i class="fas fa-edit"></i> Edit
                                        </button>
                                        <bu'tton class="btn btn-delete flex-fill" onclick="deleteProduct('${product.id}')">
                                            <i class="fas fa-trash"></i> Delete
                                        </button>
                                    </div>
                                    <button class="btn btn-success w-100 mt-2" onclick="addToCart('${product.id}')">
                                        <i class="fas fa-shopping-cart"></i> Add to Cart
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('Error fetching products:', error);
                showNotification('Error fetching products', 'error');
            }
        }

        function updateStatistics(products) {
            const totalProducts = products.length;
            const availableProducts = products.filter(p => p.status === 'available').length;
            const orderProducts = products.filter(p => p.status === 'order').length;
            const avgPrice = totalProducts > 0 ? (products.reduce((sum, p) => sum + parseFloat(p.price || 0), 0) / totalProducts).toFixed(2) : 0;

            document.getElementById('totalProducts').textContent = totalProducts;
            document.getElementById('availableProducts').textContent = availableProducts;
            document.getElementById('orderProducts').textContent = orderProducts;
            document.getElementById('avgPrice').textContent = `$${avgPrice}`;
        }

        function getGenderIcon(gender) {
            switch(gender) {
                case 'male': return 'fa-mars';
                case 'female': return 'fa-venus';
                case 'child': return 'fa-child';
                default: return 'fa-users';
            }
        }

        function escapeQuotes(str) {
            return str ? str.replace(/'/g, "\\'").replace(/"/g, '\\"') : '';
        }

        async function addProduct() {
            const name = document.getElementById('productName').value.trim();
            const description = document.getElementById('productDescription').value.trim();
            const price = document.getElementById('productPrice').value.trim();
            const gender = document.getElementById('productGender').value;
            const status = document.getElementById('productStatus').value;
            const descriptionURL = document.getElementById('productDescriptionURL').value.trim();
            const website = document.getElementById('productWebsite').value.trim();
            
            // Get image (either from file or URL)
            const imageFile = document.getElementById('productImageFile').files[0];
            const imageURL = document.getElementById('productImageURL').value.trim();

            if (!name || !description || !price || !gender || !status) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }

            if (!imageFile && !imageURL) {
                showNotification('Please provide either an image file or image URL', 'error');
                return;
            }

            try {
                let finalImageURL = imageURL;
                
                // If file is selected, convert to base64 (for demo purposes)
                // In production, you'd upload to a proper image hosting service
                if (imageFile) {
                    finalImageURL = await convertFileToBase64(imageFile);
                }

                const productData = {
                    name,
                    description,
                    price: parseFloat(price),
                    image: finalImageURL,
                    gender,
                    status,
                    descriptionURL: descriptionURL || null,
                    website: website || null
                };

                await axios.post(API_URL, productData);
                showNotification('Product added successfully!', 'success');
                
                // Reset form
                document.getElementById('addProductForm').reset();
                document.getElementById('imagePreview').style.display = 'none';
                
                fetchProducts();
            } catch (error) {
                console.error('Error adding product:', error);
                showNotification('Error adding product. Please try again.', 'error');
            }
        }

        function convertFileToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve(reader.result);
                reader.onerror = error => reject(error);
            });
        }

        async function deleteProduct(productId) {
            if (!confirm('Are you sure you want to delete this product? This action cannot be undone.')) {
                return;
            }

            try {
                await axios.delete(`${API_URL}/${productId}`);
                showNotification('Product deleted successfully!', 'success');
                fetchProducts();
            } catch (error) {
                console.error('Error deleting product:', error);
                showNotification('Error deleting product. Please try again.', 'error');
            }
        }

        function openEditModal(id, name, description, price, image, gender, status, descriptionURL, website) {
            document.getElementById('editProductId').value = id;
            document.getElementById('editProductName').value = name;
            document.getElementById('editProductDescription').value = description;
            document.getElementById('editProductPrice').value = price;
            document.getElementById('editProductImageURL').value = image;
            document.getElementById('editProductGender').value = gender || 'unisex';
            document.getElementById('editProductStatus').value = status || 'available';
            document.getElementById('editProductDescriptionURL').value = descriptionURL || '';
            document.getElementById('editProductWebsite').value = website || '';

            const editModal = new bootstrap.Modal(document.getElementById('editProductModal'));
            editModal.show();
        }

        async function updateProduct() {
            const id = document.getElementById('editProductId').value;
            const name = document.getElementById('editProductName').value.trim();
            const description = document.getElementById('editProductDescription').value.trim();
            const price = document.getElementById('editProductPrice').value.trim();
            const imageURL = document.getElementById('editProductImageURL').value.trim();
            const gender = document.getElementById('editProductGender').value;
            const status = document.getElementById('editProductStatus').value;
            const descriptionURL = document.getElementById('editProductDescriptionURL').value.trim();
            const website = document.getElementById('editProductWebsite').value.trim();

            if (!name || !description || !price || !imageURL || !gender || !status) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }

            try {
                const productData = {
                    name,
                    description,
                    price: parseFloat(price),
                    image: imageURL,
                    gender,
                    status,
                    descriptionURL: descriptionURL || null,
                    website: website || null
                };

                await axios.put(`${API_URL}/${id}`, productData);
                showNotification('Product updated successfully!', 'success');
                fetchProducts();

                const editModal = bootstrap.Modal.getInstance(document.getElementById('editProductModal'));
                editModal.hide();
            } catch (error) {
                console.error('Error updating product:', error);
                showNotification('Error updating product. Please try again.', 'error');
            }
        }

        // Cart functionality (stored in memory for demo)
        let cart = [];

        function addToCart(productId) {
            // Find product in current products list
            axios.get(`${API_URL}/${productId}`)
                .then(response => {
                    const product = response.data;
                    const existingItem = cart.find(item => item.id === productId);
                    
                    if (existingItem) {
                        existingItem.quantity += 1;
                        showNotification(`${product.name} quantity increased in cart!`, 'success');
                    } else {
                        cart.push({
                            id: productId,
                            name: product.name,
                            price: product.price,
                            image: product.image,
                            quantity: 1
                        });
                        showNotification(`${product.name} added to cart!`, 'success');
                    }
                    
                    updateCartDisplay();
                })
                .catch(error => {
                    console.error('Error adding to cart:', error);
                    showNotification('Error adding to cart', 'error');
                });
        }

        function updateCartDisplay() {
            // You can implement a cart display here
            console.log('Cart updated:', cart);
        }

        function showNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `alert alert-${type === 'error' ? 'danger' : type === 'success' ? 'success' : 'info'} alert-dismissible fade show position-fixed`;
            notification.style.top = '20px';
            notification.style.right = '20px';
            notification.style.zIndex = '9999';
            notification.style.minWidth = '300px';
            
            notification.innerHTML = `
                <i class="fas fa-${type === 'error' ? 'exclamation-circle' : type === 'success' ? 'check-circle' : 'info-circle'}"></i>
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            
            document.body.appendChild(notification);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 5000);
        }

        // Theme toggle functionality
        function toggleTheme() {
            const body = document.body;
            const themeToggle = document.getElementById('themeToggle');

            body.classList.toggle('dark-theme');

            if (body.classList.contains('dark-theme')) {
                themeToggle.innerHTML = '<i class="fas fa-sun"></i> Light-mode';
                localStorage.setItem('theme', 'dark');
            } else {
                themeToggle.innerHTML = '<i class="fas fa-moon"></i> Dark-mode';
                localStorage.setItem('theme', 'light');
            }
        }

        // Load saved theme
        document.addEventListener('DOMContentLoaded', function () {
            const savedTheme = localStorage.getItem('theme');
            const themeToggle = document.getElementById('themeToggle');

            if (savedTheme === 'dark') {
                document.body.classList.add('dark-theme');
                themeToggle.innerHTML = '<i class="fas fa-sun"></i> Light-mode';
            }

            // Load products on page load
            fetchProducts();
        });

        // Search and filter functionality
        function filterProducts() {
            const searchTerm = document.getElementById('searchInput')?.value.toLowerCase() || '';
            const genderFilter = document.getElementById('genderFilter')?.value || '';
            const statusFilter = document.getElementById('statusFilter')?.value || '';
            
            // This would filter the displayed products
            // Implementation depends on your specific needs
        }

        // Export data functionality
        function exportData() {
            axios.get(API_URL)
                .then(response => {
                    const products = response.data;
                    const dataStr = JSON.stringify(products, null, 2);
                    const dataBlob = new Blob([dataStr], {type: 'application/json'});
                    const url = URL.createObjectURL(dataBlob);
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = 'products_export.json';
                    link.click();
                    URL.revokeObjectURL(url);
                    showNotification('Data exported successfully!', 'success');
                })
                .catch(error => {
                    console.error('Error exporting data:', error);
                    showNotification('Error exporting data', 'error');
                });
        }

        // Bulk operations
        function bulkDelete() {
            const checkboxes = document.querySelectorAll('.product-checkbox:checked');
            if (checkboxes.length === 0) {
                showNotification('Please select products to delete', 'error');
                return;
            }

            if (!confirm(`Are you sure you want to delete ${checkboxes.length} products?`)) {
                return;
            }

            const deletePromises = Array.from(checkboxes).map(checkbox => 
                axios.delete(`${API_URL}/${checkbox.value}`)
            );

            Promise.all(deletePromises)
                .then(() => {
                    showNotification(`${checkboxes.length} products deleted successfully!`, 'success');
                    fetchProducts();
                })
                .catch(error => {
                    console.error('Error in bulk delete:', error);
                    showNotification('Error deleting some products', 'error');
                });
        }

        // Advanced search with debouncing
        let searchTimeout;
        function handleSearch(event) {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                const searchTerm = event.target.value.toLowerCase();
                // Implement search logic here
                filterProducts();
            }, 300);
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(event) {
            // Ctrl/Cmd + N to add new product
            if ((event.ctrlKey || event.metaKey) && event.key === 'n') {
                event.preventDefault();
                document.getElementById('productName').focus();
            }
            
            // Escape to close modals
            if (event.key === 'Escape') {
                const openModal = document.querySelector('.modal.show');
                if (openModal) {
                    const modal = bootstrap.Modal.getInstance(openModal);
                    modal.hide();
                }
            }
        });

        // Form validation enhancement
        function validateForm(formId) {
            const form = document.getElementById(formId);
            const inputs = form.querySelectorAll('input[required], select[required], textarea[required]');
            let isValid = true;

            inputs.forEach(input => {
                if (!input.value.trim()) {
                    input.classList.add('is-invalid');
                    isValid = false;
                } else {
                    input.classList.remove('is-invalid');
                }
            });

            return isValid;
        }

        // Auto-save draft functionality
        function saveDraft() {
            const formData = {
                name: document.getElementById('productName').value,
                description: document.getElementById('productDescription').value,
                price: document.getElementById('productPrice').value,
                gender: document.getElementById('productGender').value,
                status: document.getElementById('productStatus').value,
                descriptionURL: document.getElementById('productDescriptionURL').value,
                website: document.getElementById('productWebsite').value,
                imageURL: document.getElementById('productImageURL').value
            };
            
            sessionStorage.setItem('productDraft', JSON.stringify(formData));
        }

        function loadDraft() {
            const draft = sessionStorage.getItem('productDraft');
            if (draft) {
                const formData = JSON.parse(draft);
                document.getElementById('productName').value = formData.name || '';
                document.getElementById('productDescription').value = formData.description || '';
                document.getElementById('productPrice').value = formData.price || '';
                document.getElementById('productGender').value = formData.gender || '';
                document.getElementById('productStatus').value = formData.status || '';
                document.getElementById('productDescriptionURL').value = formData.descriptionURL || '';
                document.getElementById('productWebsite').value = formData.website || '';
                document.getElementById('productImageURL').value = formData.imageURL || '';
            }
        }

        // Load draft on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadDraft();
            
            // Auto-save every 30 seconds
            setInterval(saveDraft, 30000);
        });

        // Clear draft when product is successfully added
        function clearDraft() {
            sessionStorage.removeItem('productDraft');
        }
    </script>
</body>

</html>