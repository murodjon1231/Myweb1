<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🇺🇸TuronMarket🇺🇿 - Savat</title>
    <link rel="icon" href="./ChatGPT Image 28 мая 2025 г., 22_39_24.png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="Theme.css">
    <link rel="stylesheet" href="footer.css">
    <script src="load-navbar.js"></script>
    <script src="floating-message.js"></script>

    <style>
        .cart-container {
            padding: 40px 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .cart-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .cart-title {
            font-size: 2.5rem;
            font-weight: 800;
            color: #2d3748;
            margin-bottom: 15px;
        }

        .cart-empty {
            text-align: center;
            padding: 60px 20px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .cart-empty i {
            font-size: 4rem;
            color: #cbd5e0;
            margin-bottom: 20px;
        }

        .cart-empty h3 {
            font-size: 1.8rem;
            color: #4a5568;
            margin-bottom: 15px;
        }

        .cart-empty p {
            color: #718096;
            margin-bottom: 30px;
        }

        .cart-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
        }

        .cart-items {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .cart-item {
            display: grid;
            grid-template-columns: auto 3fr 1fr auto;
            gap: 20px;
            padding: 20px;
            border-bottom: 1px solid #e2e8f0;
            align-items: center;
        }

        .cart-item:last-child {
            border-bottom: none;
        }

        .item-image {
            width: 100px;
            height: 100px;
            border-radius: 10px;
            overflow: hidden;
        }

        .item-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .item-details h3 {
            font-size: 1.2rem;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 8px;
        }

        .item-details p {
            color: #718096;
            margin-bottom: 5px;
        }

        .item-size {
            display: inline-block;
            padding: 4px 12px;
            background: #edf2f7;
            border-radius: 15px;
            font-size: 0.9rem;
            color: #4a5568;
            margin-top: 5px;
        }

        .item-price {
            font-size: 1.3rem;
            font-weight: 700;
            color: #2d3748;
        }

        .item-actions {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .quantity-control {
            display: flex;
            align-items: center;
            gap: 10px;
            background: #f7fafc;
            padding: 8px;
            border-radius: 10px;
        }

        .quantity-btn {
            width: 30px;
            height: 30px;
            border: none;
            border-radius: 8px;
            background: white;
            color: #4a5568;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .quantity-btn:hover {
            background: #e2e8f0;
            color: #2d3748;
        }

        .quantity-value {
            font-weight: 600;
            color: #2d3748;
            min-width: 30px;
            text-align: center;
        }

        .remove-btn {
            background: none;
            border: none;
            color: #e53e3e;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 8px;
            border-radius: 8px;
        }

        .remove-btn:hover {
            background: #fed7d7;
        }

        .cart-summary {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 100px;
        }

        .summary-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e2e8f0;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            color: #4a5568;
        }

        .summary-total {
            font-size: 1.3rem;
            font-weight: 700;
            color: #2d3748;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid #e2e8f0;
        }

        .checkout-form {
            margin-top: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 8px;
        }

        .form-control {
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            border-color: #4299e1;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.2);
        }

        .checkout-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(45deg, #4299e1, #3182ce);
            border: none;
            border-radius: 10px;
            color: white;
            font-weight: 600;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .checkout-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(49, 130, 206, 0.3);
        }

        .checkout-btn:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        @media (max-width: 768px) {
            .cart-grid {
                grid-template-columns: 1fr;
            }

            .cart-item {
                grid-template-columns: 1fr;
                text-align: center;
            }

            .item-image {
                margin: 0 auto;
            }

            .item-actions {
                justify-content: center;
            }

            .cart-summary {
                position: static;
            }
        }

        /* Dark Theme Styles */
        .dark-theme .cart-title {
            color: #e2e8f0;
        }

        .dark-theme .cart-empty,
        .dark-theme .cart-items,
        .dark-theme .cart-summary {
            background: #2d3748;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .dark-theme .cart-empty i {
            color: #4a5568;
        }

        .dark-theme .cart-empty h3 {
            color: #e2e8f0;
        }

        .dark-theme .cart-empty p {
            color: #a0aec0;
        }

        .dark-theme .cart-item {
            border-bottom-color: #4a5568;
        }

        .dark-theme .item-details h3 {
            color: #e2e8f0;
        }

        .dark-theme .item-details p {
            color: #a0aec0;
        }

        .dark-theme .item-size {
            background: #4a5568;
            color: #e2e8f0;
        }

        .dark-theme .item-price {
            color: #e2e8f0;
        }

        .dark-theme .quantity-control {
            background: #4a5568;
        }

        .dark-theme .quantity-btn {
            background: #2d3748;
            color: #e2e8f0;
        }

        .dark-theme .quantity-btn:hover {
            background: #4a5568;
        }

        .dark-theme .quantity-value {
            color: #e2e8f0;
        }

        .dark-theme .remove-btn:hover {
            background: #63171b;
        }

        .dark-theme .summary-title {
            color: #e2e8f0;
            border-bottom-color: #4a5568;
        }

        .dark-theme .summary-item {
            color: #a0aec0;
        }

        .dark-theme .summary-total {
            color: #e2e8f0;
            border-top-color: #4a5568;
        }

        .dark-theme .form-label {
            color: #e2e8f0;
        }

        .dark-theme .form-control {
            background: #2d3748;
            border-color: #4a5568;
            color: #e2e8f0;
        }

        .dark-theme .form-control:focus {
            border-color: #90cdf4;
            box-shadow: 0 0 0 3px rgba(144, 205, 244, 0.2);
        }

        .dark-theme .checkout-btn:disabled {
            background: #4a5568;
        }
    </style>
</head>

<body>
    <main style="margin-top: 76px;">
                <div class="cart-container">
            <div class="cart-header">
                <h1 class="cart-title">Savat</h1>
                    </div>

            <div id="cartContent">
                <!-- Cart content will be loaded here -->
            </div>
        </div>
    </main>

    <!-- Footer Section -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <!-- About Section -->
                <div class="footer-section">
                    <h3>Biz haqimizda</h3>
                    <p>TuronMarket - O'zbekistondagi eng yirik Amerika brendlari do'koni. Sifatli mahsulotlar va tez yetkazib berish xizmati.</p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-telegram"></i></a>
                        <a href="#"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>

                <!-- Quick Links -->
                <div class="footer-section">
                    <h3>Tezkor havolalar</h3>
                    <ul class="footer-links">
                        <li><a href="index.html"><i class="fas fa-home"></i> Bosh sahifa</a></li>
                        <li><a href="products.html"><i class="fas fa-shopping-bag"></i> Mahsulotlar</a></li>
                        <li><a href="contacts.html"><i class="fas fa-envelope"></i> Bog'lanish</a></li>
                        <li><a href="know-the-price.html"><i class="fas fa-dollar-sign"></i> Narxlarni bilish</a></li>
                    </ul>
                </div>

                <!-- Contact Info -->
                <div class="footer-section">
                    <h3>Bog'lanish</h3>
                    <div class="contact-info">
                        <div class="contact-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>123 Turon ko'chasi, Tashkent, O'zbekiston</span>
                        </div>
                        <div class="contact-item">
                            <i class="fas fa-phone"></i>
                            <span>+998 90 123 45 67</span>
                        </div>
                        <div class="contact-item">
                            <i class="fas fa-envelope"></i>
                            <span>info@turonmarket.uz</span>
                        </div>
                    </div>
                </div>

                <!-- Newsletter -->
                <div class="footer-section">
                    <h3>Yangiliklardan xabardor bo'ling</h3>
                    <p>Yangi mahsulotlar va maxsus takliflar haqida birinchilardan bo'lib xabardor bo'ling!</p>
                    <form class="newsletter-form">
                        <input type="email" class="newsletter-input" placeholder="Email manzilingiz">
                        <button type="submit" class="newsletter-button">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </form>
                </div>
            </div>

            <!-- Footer Bottom -->
            <div class="footer-bottom">
                <div class="footer-logo">TuronMarket</div>
                <p>&copy; 2024 TuronMarket. Barcha huquqlar himoyalangan.</p>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        let cart = [];

        // Load cart on page load
        document.addEventListener('DOMContentLoaded', () => {
            cart = JSON.parse(localStorage.getItem('cart')) || [];
            loadCart();
            updateCartCounter();
        });

        // Load cart content
        function loadCart() {
            const cartContent = document.getElementById('cartContent');
            
            if (!cart || cart.length === 0) {
                cartContent.innerHTML = `
                    <div class="cart-empty">
                        <i class="fas fa-shopping-cart"></i>
                        <h3>Savatingiz bo'sh</h3>
                        <p>Hali hech qanday mahsulot qo'shilmagan.</p>
                        <a href="products.html" class="checkout-btn">
                            Xarid qilishni boshlash
                        </a>
                    </div>
                `;
                return;
            }

            const subtotal = cart.reduce((total, item) => total + (item.price * item.quantity), 0);
            const shipping = 0; // Free shipping
            const total = subtotal + shipping;

            // Get user data if logged in
            const currentUser = JSON.parse(localStorage.getItem('currentUser')) || {};
            const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';

            cartContent.innerHTML = `
                <div class="cart-grid">
                    <div class="cart-items">
                        ${cart.map((item, index) => `
                            <div class="cart-item">
                    <div class="item-image">
                                    <img src="${item.image}" alt="${item.name}" onerror="this.src='placeholder.jpg'">
                    </div>
                    <div class="item-details">
                                    <h3>${item.name}</h3>
                                    <p>Narxi: $${item.price}</p>
                                    ${item.size ? `<span class="item-size">O'lcham: ${item.size}</span>` : ''}
                                </div>
                                <div class="item-price">
                                    $${(item.price * item.quantity).toFixed(2)}
                        </div>
                        <div class="item-actions">
                                    <div class="quantity-control">
                                        <button class="quantity-btn" onclick="updateQuantity(${index}, -1)">
                                    <i class="fas fa-minus"></i>
                                </button>
                                        <span class="quantity-value">${item.quantity}</span>
                                <button class="quantity-btn" onclick="updateQuantity(${index}, 1)">
                                    <i class="fas fa-plus"></i>
                                </button>
                                    </div>
                                    <button class="remove-btn" onclick="removeItem(${index})">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        `).join('')}
                    </div>

                    <div class="cart-summary">
                        <h2 class="summary-title">Buyurtma ma'lumotlari</h2>
                        <div class="summary-item">
                            <span>Mahsulotlar narxi:</span>
                            <span>$${subtotal.toFixed(2)}</span>
                        </div>
                        <div class="summary-item">
                            <span>Yetkazib berish:</span>
                            <span>Bepul</span>
                        </div>
                        <div class="summary-total">
                            <span>Jami:</span>
                            <span>$${total.toFixed(2)}</span>
                            </div>
                            
                        <form class="checkout-form" id="checkoutForm" autocomplete="on">
                            <div class="form-group">
                                <label class="form-label" for="firstName">Ismingiz *</label>
                                <input type="text" class="form-control" id="firstName" required placeholder="Ismingiz" value="${isLoggedIn ? (currentUser.firstName || '') : ''}">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="lastName">Familiyangiz *</label>
                                <input type="text" class="form-control" id="lastName" required placeholder="Familiyangiz" value="${isLoggedIn ? (currentUser.lastName || '') : ''}">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="telegram">Telegram username *</label>
                                <input type="text" class="form-control" id="telegram" required placeholder="@username" value="${isLoggedIn ? (currentUser.telegram || '') : ''}">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="phone">Telefon raqamingiz *</label>
                                <input type="tel" class="form-control" id="phone" required placeholder="998901234567" value="${isLoggedIn ? (currentUser.phone || '') : ''}">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="address">Manzilingiz *</label>
                                <textarea class="form-control" id="address" rows="3" required placeholder="Manzilingiz">${isLoggedIn ? (currentUser.address || '') : ''}</textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="notes">Qo'shimcha ma'lumot</label>
                                <textarea class="form-control" id="notes" rows="2" placeholder="Qo'shimcha izoh"></textarea>
                            </div>
                            <button type="submit" class="checkout-btn">
                                Buyurtma berish
                            </button>
                        </form>
                    </div>
                </div>
            `;

            // Add form submit handler
            document.getElementById('checkoutForm').addEventListener('submit', handleCheckout);

            // Autofill on input change (real-time update for logged-in user)
            if (isLoggedIn) {
                const fields = ['firstName', 'lastName', 'telegram', 'phone', 'address'];
                fields.forEach(field => {
                    const input = document.getElementById(field);
                    if (input) {
                        input.addEventListener('input', (e) => {
                            currentUser[field] = e.target.value;
                            localStorage.setItem('currentUser', JSON.stringify(currentUser));
                        });
                    }
                });
            }
        }

        // Update item quantity
        function updateQuantity(index, change) {
            const item = cart[index];
            const newQuantity = item.quantity + change;

            if (newQuantity < 1) {
                removeItem(index);
                return;
            }

            item.quantity = newQuantity;
                    localStorage.setItem('cart', JSON.stringify(cart));
                    loadCart();
                    updateCartCounter();
        }

        // Remove item from cart
        function removeItem(index) {
            cart.splice(index, 1);
            localStorage.setItem('cart', JSON.stringify(cart));
            loadCart();
            updateCartCounter();
            showNotification('Mahsulot savatdan o\'chirildi', 'info');
        }

        // Handle checkout
        async function handleCheckout(e) {
            e.preventDefault();

            // Check if user is logged in
            const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
            if (!isLoggedIn) {
                showNotification('Iltimos, avval tizimga kiring!', 'warning');
                setTimeout(() => {
                    window.location.href = 'login.html';
                }, 1500);
                return;
            }

            if (!cart || cart.length === 0) {
                showNotification('Savatingiz bo\'sh!', 'warning');
                return;
            }

            const firstName = document.getElementById('firstName').value.trim();
            const lastName = document.getElementById('lastName').value.trim();
            const telegram = document.getElementById('telegram').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const address = document.getElementById('address').value.trim();
            const notes = document.getElementById('notes').value.trim();

            if (!firstName || !lastName || !telegram || !phone || !address) {
                showNotification('Iltimos, barcha maydonlarni to\'ldiring!', 'warning');
                return;
            }

            // Calculate totals
                const subtotal = cart.reduce((total, item) => total + (item.price * item.quantity), 0);
                const advancePayment = subtotal * 0.3;

            // Save payment data for payment page
                const paymentData = {
                subtotal,
                advancePayment,
                    customerInfo: {
                        firstName,
                        lastName,
                        telegram,
                        phone,
                        address,
                        notes
                    },
                cart: [...cart]
                };

                localStorage.setItem('paymentData', JSON.stringify(paymentData));

            // Redirect to payment page
            showNotification('To\'lov sahifasiga o\'tkazilmoqda...', 'info');
                setTimeout(() => {
                    window.location.href = 'payment.html';
            }, 1500);
        }

        // Show notification
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            
            const icon = type === 'success' ? 'check-circle' :
                        type === 'error' ? 'times-circle' :
                        type === 'warning' ? 'exclamation-triangle' :
                        'info-circle';
            
            const gradient = type === 'success' ? 'linear-gradient(45deg, #48bb78, #38a169)' :
                            type === 'error' ? 'linear-gradient(45deg, #f56565, #c53030)' :
                            type === 'warning' ? 'linear-gradient(45deg, #ed8936, #dd6b20)' :
                            'linear-gradient(45deg, #4299e1, #2b6cb0)';
            
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 25px;
                border-radius: 10px;
                background: ${gradient};
                color: white;
                font-weight: 600;
                z-index: 10000;
                display: flex;
                align-items: center;
                gap: 10px;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
                transform: translateX(120%);
                transition: transform 0.3s ease;
            `;
            
            notification.innerHTML = `
                <i class="fas fa-${icon}"></i>
                <span>${message}</span>
            `;
            
            document.body.appendChild(notification);
            
            requestAnimationFrame(() => {
                notification.style.transform = 'translateX(0)';
            });
            
            setTimeout(() => {
                notification.style.transform = 'translateX(120%)';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // Update cart counter
        function updateCartCounter() {
            const cartCounter = document.querySelector('.cart-counter');
            if (!cartCounter) return;

            const totalItems = cart.reduce((sum, item) => sum + (item.quantity || 0), 0);
            
            if (totalItems > 0) {
                cartCounter.textContent = totalItems > 99 ? '99+' : totalItems;
                cartCounter.classList.remove('hidden');
            } else {
                cartCounter.classList.add('hidden');
            }
        }
    </script>
</body>

</html>